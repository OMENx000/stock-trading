{% extends "layout.html" %}
{% from "macros.html" import secure_form %}

{% block title %}
    {{ info.name if info else "Stock" }}
{% endblock %}

{% block main_id %}company-stock-page{% endblock %}

{% block main %}
    {% if info %}
        <div class="stock-info-box">
            <img src="https://www.google.com/s2/favicons?domain={{ info.domain }}&sz=64" alt="favicon">
            <h3>{{ info.longName }}</h3>
            <p><strong>Symbol:</strong> {{ info.symbol }}</p>
            <p><strong>Price:</strong> ${{ info.price }}</p>
            <!-- Placeholder for graph -->
            <div id="stock-graph">
                <p class="text-muted">[Graph will appear here]</p>
            </div>
        </div>
        <div id="buy_container">
            <button class="btn btn-primary ms-1" id="show" type="button">BUY</button>
        </div>


        <!-- Hidden  form -->
        <div id="form-overlay" style="display: none;">
            <div id="form-modal" class="modal-container">
                {% call secure_form("/buy") %}
                    <div class="input-group gap-3">
                        <input type="hidden" name="symbol" value="{{ info.symbol }}">
                        <input class="form-control mx-auto w-auto" id="hidden-input" name="quantity" placeholder="Quantity" type="number" min="1">
                        <button class="btn btn-primary" id="company_name_button" type="submit">BUY</button>
                    </div>
                {% endcall %}
            </div>
        </div>
    {% else %}
        <p class="text-danger">No stock information available.</p>
    {% endif %}
{% endblock %}